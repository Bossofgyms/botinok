<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–∞—Ä–æ –†–∞—Å–∫–ª–∞–¥</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>–¢–∞—Ä–æ –†–∞—Å–∫–ª–∞–¥</h1>
            <div class="question">
                <strong>–í–æ–ø—Ä–æ—Å:</strong> <span id="questionText">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
            <div class="counter">
                –í—ã–±—Ä–∞–Ω–æ: <span id="selectedCount">0</span>/3 –∫–∞—Ä—Ç
            </div>
        </div>

        <div id="cardsContainer" class="cards-container">
            <!-- –ö–∞—Ä—Ç—ã –±—É–¥—É—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –∑–¥–µ—Å—å -->
        </div>

        <div id="resultsContainer" class="results-container" style="display:none;">
            <div class="results-title">–í—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã:</div>
            <div class="selected-cards" id="selectedCardsList"></div>
        </div>

        <div class="actions">
            <button id="submitBtn" class="submit-btn" disabled>
                üì® –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å–∫–ª–∞–¥
            </button>
            <button id="shuffleBtn" class="shuffle-btn">
                üîÑ –ü–µ—Ä–µ–º–µ—à–∞—Ç—å –∫–∞—Ä—Ç—ã
            </button>
        </div>

        <div class="instructions">
            üí° –í—ã–±–µ—Ä–∏—Ç–µ 3 –∫–∞—Ä—Ç—ã –¥–ª—è —Ä–∞—Å–∫–ª–∞–¥–∞. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç—É, —á—Ç–æ–±—ã –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å –∏ –≤—ã–±—Ä–∞—Ç—å.
        </div>
    </div>
    <script>
        // –ü–æ–ª–Ω–∞—è –∫–æ–ª–æ–¥–∞ –¢–∞—Ä–æ - 78 –∫–∞—Ä—Ç
        const TAROT_DECK = [
            // –°–¢–ê–†–®–ò–ï –ê–†–ö–ê–ù–´ (22 –∫–∞—Ä—Ç—ã)
            { 
                name: "0. –®—É—Ç", 
                meaning: "–ù–∞—á–∞–ª–æ, –Ω–µ–≤–∏–Ω–Ω–æ—Å—Ç—å, —Å–ø–æ–Ω—Ç–∞–Ω–Ω–æ—Å—Ç—å", 
                image: "images/fool.jpg",
                type: "major"
            },
            { 
                name: "I. –ú–∞–≥", 
                meaning: "–í–æ–ª—è, –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ, –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è", 
                image: "images/magician.jpg",
                type: "major"
            },
            { 
                name: "II. –í–µ—Ä—Ö–æ–≤–Ω–∞—è –ñ—Ä–∏—Ü–∞", 
                meaning: "–ò–Ω—Ç—É–∏—Ü–∏—è, —Ç–∞–π–Ω—ã, –º—É–¥—Ä–æ—Å—Ç—å", 
                image: "images/high_priestess.jpg",
                type: "major"
            },
            { 
                name: "III. –ò–º–ø–µ—Ä–∞—Ç—Ä–∏—Ü–∞", 
                meaning: "–ò–∑–æ–±–∏–ª–∏–µ, —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ, –ø—Ä–∏—Ä–æ–¥–∞", 
                image: "images/empress.jpg",
                type: "major"
            },
            { 
                name: "IV. –ò–º–ø–µ—Ä–∞—Ç–æ—Ä", 
                meaning: "–í–ª–∞—Å—Ç—å, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∫–æ–Ω—Ç—Ä–æ–ª—å", 
                image: "images/emperor.jpg",
                type: "major"
            },
            { 
                name: "V. –ò–µ—Ä–æ—Ñ–∞–Ω—Ç", 
                meaning: "–¢—Ä–∞–¥–∏—Ü–∏—è, –≤–µ—Ä–∞, –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å", 
                image: "images/hierophant.jpg",
                type: "major"
            },
            { 
                name: "VI. –í–ª—é–±–ª–µ–Ω–Ω—ã–µ", 
                meaning: "–í—ã–±–æ—Ä, –æ—Ç–Ω–æ—à–µ–Ω–∏—è, –≥–∞—Ä–º–æ–Ω–∏—è", 
                image: "images/lovers.jpg",
                type: "major"
            },
            { 
                name: "VII. –ö–æ–ª–µ—Å–Ω–∏—Ü–∞", 
                meaning: "–î–≤–∏–∂–µ–Ω–∏–µ, –ø–æ–±–µ–¥–∞, –∫–æ–Ω—Ç—Ä–æ–ª—å", 
                image: "images/chariot.jpg",
                type: "major"
            },
            { 
                name: "VIII. –°–∏–ª–∞", 
                meaning: "–ú—É–∂–µ—Å—Ç–≤–æ, —Å—Ç—Ä–∞—Å—Ç—å, –≤–ª–∏—è–Ω–∏–µ", 
                image: "images/strength.jpg",
                type: "major"
            },
            { 
                name: "IX. –û—Ç—à–µ–ª—å–Ω–∏–∫", 
                meaning: "–°–∞–º–æ–∞–Ω–∞–ª–∏–∑, —É–µ–¥–∏–Ω–µ–Ω–∏–µ, –º—É–¥—Ä–æ—Å—Ç—å", 
                image: "images/hermit.jpg",
                type: "major"
            },
            { 
                name: "X. –ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã", 
                meaning: "–°—É–¥—å–±–∞, —Ü–∏–∫–ª—ã, —É–¥–∞—á–∞", 
                image: "images/wheel.jpg",
                type: "major"
            },
            { 
                name: "XI. –°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å", 
                meaning: "–ë–∞–ª–∞–Ω—Å, –ø—Ä–∞–≤–¥–∞, –∫–∞—Ä–º–∞", 
                image: "images/justice.jpg",
                type: "major"
            },
            { 
                name: "XII. –ü–æ–≤–µ—à–µ–Ω–Ω—ã–π", 
                meaning: "–ñ–µ—Ä—Ç–≤–∞, —Å–¥–∞—á–∞, –Ω–æ–≤–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞", 
                image: "images/hanged.jpg",
                type: "major"
            },
            { 
                name: "XIII. –°–º–µ—Ä—Ç—å", 
                meaning: "–ö–æ–Ω–µ—Ü, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è, –ø–µ—Ä–µ—Ö–æ–¥", 
                image: "images/death.jpg",
                type: "major"
            },
            { 
                name: "XIV. –£–º–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å", 
                meaning: "–ë–∞–ª–∞–Ω—Å, —Ç–µ—Ä–ø–µ–Ω–∏–µ, –≥–∞—Ä–º–æ–Ω–∏—è", 
                image: "images/temperance.jpg",
                type: "major"
            },
            { 
                name: "XV. –î—å—è–≤–æ–ª", 
                meaning: "–ò—Å–∫—É—à–µ–Ω–∏–µ, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å, –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–º", 
                image: "images/devil.jpg",
                type: "major"
            },
            { 
                name: "XVI. –ë–∞—à–Ω—è", 
                meaning: "–í–Ω–µ–∑–∞–ø–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –æ—Ç–∫—Ä–æ–≤–µ–Ω–∏–µ", 
                image: "images/tower.jpg",
                type: "major"
            },
            { 
                name: "XVII. –ó–≤–µ–∑–¥–∞", 
                meaning: "–ù–∞–¥–µ–∂–¥–∞, –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ, –¥—É—Ö–æ–≤–Ω–æ—Å—Ç—å", 
                image: "images/star.jpg",
                type: "major"
            },
            { 
                name: "XVIII. –õ—É–Ω–∞", 
                meaning: "–ò–ª–ª—é–∑–∏—è, —Å—Ç—Ä–∞—Ö, –ø–æ–¥—Å–æ–∑–Ω–∞–Ω–∏–µ", 
                image: "images/moon.jpg",
                type: "major"
            },
            { 
                name: "XIX. –°–æ–ª–Ω—Ü–µ", 
                meaning: "–†–∞–¥–æ—Å—Ç—å, —É—Å–ø–µ—Ö, –∂–∏–∑–Ω–µ–Ω–Ω–∞—è —Å–∏–ª–∞", 
                image: "images/sun.jpg",
                type: "major"
            },
            { 
                name: "XX. –°—É–¥", 
                meaning: "–í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–µ, –ø—Ä–∏–∑—ã–≤, –ø—Ä–æ—â–µ–Ω–∏–µ", 
                image: "images/judgement.jpg",
                type: "major"
            },
            { 
                name: "XXI. –ú–∏—Ä", 
                meaning: "–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ, –µ–¥–∏–Ω—Å—Ç–≤–æ, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ", 
                image: "images/world.jpg",
                type: "major"
            },

            // –ú–õ–ê–î–®–ò–ï –ê–†–ö–ê–ù–´ - –ñ–ï–ó–õ–´ (14 –∫–∞—Ä—Ç)
            { 
                name: "–¢—É–∑ –ñ–µ–∑–ª–æ–≤", 
                meaning: "–í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ, —ç–Ω–µ—Ä–≥–∏—è, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª", 
                image: "images/wands01.jpg",
                type: "wands"
            },
            { 
                name: "2 –ñ–µ–∑–ª–æ–≤", 
                meaning: "–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–µ—à–µ–Ω–∏–µ, –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ", 
                image: "images/wands02.jpg",
                type: "wands"
            },
            { 
                name: "3 –ñ–µ–∑–ª–æ–≤", 
                meaning: "–ü—Ä–µ–¥–≤–∏–¥–µ–Ω–∏–µ, —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ, —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ", 
                image: "images/wands03.jpg",
                type: "wands"
            },
            { 
                name: "4 –ñ–µ–∑–ª–æ–≤", 
                meaning: "–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, –ø—Ä–∞–∑–¥–Ω–∏–∫, –æ—Å–Ω–æ–≤–∞–Ω–∏–µ", 
                image: "images/wands04.jpg",
                type: "wands"
            },
            { 
                name: "5 –ñ–µ–∑–ª–æ–≤", 
                meaning: "–ö–æ–Ω—Ñ–ª–∏–∫—Ç, –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è, –¥–µ–±–∞—Ç—ã", 
                image: "images/wands05.jpg",
                type: "wands"
            },
            { 
                name: "6 –ñ–µ–∑–ª–æ–≤", 
                meaning: "–ü–æ–±–µ–¥–∞, —É—Å–ø–µ—Ö, –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ", 
                image: "images/wands06.jpg",
                type: "wands"
            },
            { 
                name: "7 –ñ–µ–∑–ª–æ–≤", 
                meaning: "–°—Ç–æ–π–∫–æ—Å—Ç—å, –≤—ã–∑–æ–≤, –∑–∞—â–∏—Ç–∞", 
                image: "images/wands07.jpg",
                type: "wands"
            },
            { 
                name: "8 –ñ–µ–∑–ª–æ–≤", 
                meaning: "–°–∫–æ—Ä–æ—Å—Ç—å, –¥–µ–π—Å—Ç–≤–∏–µ, –¥–≤–∏–∂–µ–Ω–∏–µ", 
                image: "images/wands08.jpg",
                type: "wands"
            },
            { 
                name: "9 –ñ–µ–∑–ª–æ–≤", 
                meaning: "–°–∏–ª–∞, —Å—Ç–æ–π–∫–æ—Å—Ç—å, –±–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å", 
                image: "images/wands09.jpg",
                type: "wands"
            },
            { 
                name: "10 –ñ–µ–∑–ª–æ–≤", 
                meaning: "–ë—Ä–µ–º—è, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, –¥–∞–≤–ª–µ–Ω–∏–µ", 
                image: "images/wands10.jpg",
                type: "wands"
            },
            { 
                name: "–ü–∞–∂ –ñ–µ–∑–ª–æ–≤", 
                meaning: "–≠–Ω—Ç—É–∑–∏–∞–∑–º, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ, –Ω–æ–≤–æ—Å—Ç–∏", 
                image: "images/wands11.jpg",
                type: "wands"
            },
            { 
                name: "–†—ã—Ü–∞—Ä—å –ñ–µ–∑–ª–æ–≤", 
                meaning: "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ, —ç–Ω–µ—Ä–≥–∏—è, –∏–º–ø—É–ª—å—Å", 
                image: "images/wands12.jpg",
                type: "wands"
            },
            { 
                name: "–ö–æ—Ä–æ–ª–µ–≤–∞ –ñ–µ–∑–ª–æ–≤", 
                name: "–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å, —Ö–∞—Ä–∏–∑–º–∞", 
                image: "images/wands13.jpg",
                type: "wands"
            },
            { 
                name: "–ö–æ—Ä–æ–ª—å –ñ–µ–∑–ª–æ–≤", 
                meaning: "–õ–∏–¥–µ—Ä—Å—Ç–≤–æ, –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–æ, –≤–∏–¥–µ–Ω–∏–µ", 
                image: "images/wands14.jpg",
                type: "wands"
            },

            // –ú–õ–ê–î–®–ò–ï –ê–†–ö–ê–ù–´ - –ö–£–ë–ö–ò (14 –∫–∞—Ä—Ç)
            { 
                name: "–¢—É–∑ –ö—É–±–∫–æ–≤", 
                meaning: "–ù–æ–≤–∞—è –ª—é–±–æ–≤—å, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –Ω–∞—á–∞–ª–æ", 
                image: "images/cups01.jpg",
                type: "cups"
            },
            { 
                name: "2 –ö—É–±–∫–æ–≤", 
                meaning: "–ü–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ, —Å–æ—é–∑, –ø—Ä–∏—Ç—è–∂–µ–Ω–∏–µ", 
                image: "images/cups02.jpg",
                type: "cups"
            },
            { 
                name: "3 –ö—É–±–∫–æ–≤", 
                meaning: "–ü—Ä–∞–∑–¥–Ω–∏–∫, –¥—Ä—É–∂–±–∞, —Å–æ–æ–±—â–µ—Å—Ç–≤–æ", 
                image: "images/cups03.jpg",
                type: "cups"
            },
            { 
                name: "4 –ö—É–±–∫–æ–≤", 
                meaning: "–ê–ø–∞—Ç–∏—è, —Å–æ–∑–µ—Ä—Ü–∞–Ω–∏–µ, –æ—Ç—Å—Ç—É–ø–ª–µ–Ω–∏–µ", 
                image: "images/cups04.jpg",
                type: "cups"
            },
            { 
                name: "5 –ö—É–±–∫–æ–≤", 
                meaning: "–ü–æ—Ç–µ—Ä—è, —Å–æ–∂–∞–ª–µ–Ω–∏–µ, —Ä–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ", 
                image: "images/cups05.jpg",
                type: "cups"
            },
            { 
                name: "6 –ö—É–±–∫–æ–≤", 
                meaning: "–ù–æ—Å—Ç–∞–ª—å–≥–∏—è, –Ω–µ–≤–∏–Ω–Ω–æ—Å—Ç—å, –¥–µ—Ç—Å—Ç–≤–æ", 
                image: "images/cups06.jpg",
                type: "cups"
            },
            { 
                name: "7 –ö—É–±–∫–æ–≤", 
                meaning: "–í—ã–±–æ—Ä, –∏–ª–ª—é–∑–∏–∏, –º–µ—á—Ç—ã", 
                image: "images/cups07.jpg",
                type: "cups"
            },
            { 
                name: "8 –ö—É–±–∫–æ–≤", 
                meaning: "–£—Ö–æ–¥, –ø–æ–∏—Å–∫, –æ—Ç–∫–∞–∑", 
                image: "images/cups08.jpg",
                type: "cups"
            },
            { 
                name: "9 –ö—É–±–∫–æ–≤", 
                meaning: "–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–∏–µ, –∫–æ–º—Ñ–æ—Ä—Ç, —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ", 
                image: "images/cups09.jpg",
                type: "cups"
            },
            { 
                name: "10 –ö—É–±–∫–æ–≤", 
                meaning: "–°—á–∞—Å—Ç—å–µ, —Å–µ–º—å—è, –≥–∞—Ä–º–æ–Ω–∏—è", 
                image: "images/cups10.jpg",
                type: "cups"
            },
            { 
                name: "–ü–∞–∂ –ö—É–±–∫–æ–≤", 
                meaning: "–ú–µ—á—Ç–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ", 
                image: "images/cups11.jpg",
                type: "cups"
            },
            { 
                name: "–†—ã—Ü–∞—Ä—å –ö—É–±–∫–æ–≤", 
                meaning: "–†–æ–º–∞–Ω—Ç–∏–∫–∞, –æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ, –∏–¥–µ–∞–ª–∏–∑–º", 
                image: "images/cups12.jpg",
                type: "cups"
            },
            { 
                name: "–ö–æ—Ä–æ–ª–µ–≤–∞ –ö—É–±–∫–æ–≤", 
                meaning: "–ó–∞–±–æ—Ç–∞, –∏–Ω—Ç—É–∏—Ü–∏—è, —Å–æ—Å—Ç—Ä–∞–¥–∞–Ω–∏–µ", 
                image: "images/cups13.jpg",
                type: "cups"
            },
            { 
                name: "–ö–æ—Ä–æ–ª—å –ö—É–±–∫–æ–≤", 
                meaning: "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å, –¥–∏–ø–ª–æ–º–∞—Ç–∏—è", 
                image: "images/cups14.jpg",
                type: "cups"
            },

            // –ú–õ–ê–î–®–ò–ï –ê–†–ö–ê–ù–´ - –ú–ï–ß–ò (14 –∫–∞—Ä—Ç)
            { 
                name: "–¢—É–∑ –ú–µ—á–µ–π", 
                meaning: "–ü—Ä–æ—Ä—ã–≤, —è—Å–Ω–æ—Å—Ç—å, –∏—Å—Ç–∏–Ω–∞", 
                image: "images/swords01.jpg",
                type: "swords"
            },
            { 
                name: "2 –ú–µ—á–µ–π", 
                meaning: "–¢—É–ø–∏–∫, –±–∞–ª–∞–Ω—Å, —Ä–µ—à–µ–Ω–∏–µ", 
                image: "images/swords02.jpg",
                type: "swords"
            },
            { 
                name: "3 –ú–µ—á–µ–π", 
                meaning: "–°–µ—Ä–¥–µ—á–Ω–∞—è –±–æ–ª—å, –ø–µ—á–∞–ª—å, –∫–æ–Ω—Ñ–ª–∏–∫—Ç", 
                image: "images/swords03.jpg",
                type: "swords"
            },
            { 
                name: "4 –ú–µ—á–µ–π", 
                meaning: "–û—Ç–¥—ã—Ö, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ, –º–µ–¥–∏—Ç–∞—Ü–∏—è", 
                image: "images/swords04.jpg",
                type: "swords"
            },
            { 
                name: "5 –ú–µ—á–µ–π", 
                meaning: "–ö–æ–Ω—Ñ–ª–∏–∫—Ç, —É–Ω–∏–∂–µ–Ω–∏–µ, –ø–æ—Ä–∞–∂–µ–Ω–∏–µ", 
                image: "images/swords05.jpg",
                type: "swords"
            },
            { 
                name: "6 –ú–µ—á–µ–π", 
                meaning: "–ü–µ—Ä–µ—Ö–æ–¥, –¥–≤–∏–∂–µ–Ω–∏–µ, —É–ª—É—á—à–µ–Ω–∏–µ", 
                image: "images/swords06.jpg",
                type: "swords"
            },
            { 
                name: "7 –ú–µ—á–µ–π", 
                meaning: "–û–±–º–∞–Ω, —Å—Ç—Ä–∞—Ç–µ–≥–∏—è, —Å–µ–∫—Ä–µ—Ç—ã", 
                image: "images/swords07.jpg",
                type: "swords"
            },
            { 
                name: "8 –ú–µ—á–µ–π", 
                meaning: "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, —Å—Ç—Ä–∞—Ö, –±–µ—Å–ø–æ–º–æ—â–Ω–æ—Å—Ç—å", 
                image: "images/swords08.jpg",
                type: "swords"
            },
            { 
                name: "9 –ú–µ—á–µ–π", 
                meaning: "–¢—Ä–µ–≤–æ–≥–∞, –∫–æ—à–º–∞—Ä—ã, –¥–µ–ø—Ä–µ—Å—Å–∏—è", 
                image: "images/swords09.jpg",
                type: "swords"
            },
            { 
                name: "10 –ú–µ—á–µ–π", 
                meaning: "–ö–æ–Ω–µ—Ü, –ø—Ä–µ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ, –ø–æ—Ä–∞–∂–µ–Ω–∏–µ", 
                image: "images/swords10.jpg",
                type: "swords"
            },
            { 
                name: "–ü–∞–∂ –ú–µ—á–µ–π", 
                meaning: "–õ—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –æ—Å—Ç—Ä–æ—É–º–∏–µ, –±–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å", 
                image: "images/swords11.jpg",
                type: "swords"
            },
            { 
                name: "–†—ã—Ü–∞—Ä—å –ú–µ—á–µ–π", 
                meaning: "–ê–º–±–∏—Ü–∏–∏, —Å–∫–æ—Ä–æ—Å—Ç—å, –ø—Ä—è–º–æ—Ç–∞", 
                image: "images/swords12.jpg",
                type: "swords"
            },
            { 
                name: "–ö–æ—Ä–æ–ª–µ–≤–∞ –ú–µ—á–µ–π", 
                meaning: "–Ø—Å–Ω–æ—Å—Ç—å, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å, –ø—Ä–∏–Ω—Ü–∏–ø—ã", 
                image: "images/swords13.jpg",
                type: "swords"
            },
            { 
                name: "–ö–æ—Ä–æ–ª—å –ú–µ—á–µ–π", 
                meaning: "–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç, –≤–ª–∞—Å—Ç—å, –∏—Å—Ç–∏–Ω–∞", 
                image: "images/swords14.jpg",
                type: "swords"
            },

            // –ú–õ–ê–î–®–ò–ï –ê–†–ö–ê–ù–´ - –ü–ï–ù–¢–ê–ö–õ–ò (14 –∫–∞—Ä—Ç)
            { 
                name: "–¢—É–∑ –ü–µ–Ω—Ç–∞–∫–ª–µ–π", 
                meaning: "–ü—Ä–æ—Ü–≤–µ—Ç–∞–Ω–∏–µ, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å, –∏–∑–æ–±–∏–ª–∏–µ", 
                image: "images/pents01.jpg",
                type: "pentacles"
            },
            { 
                name: "2 –ü–µ–Ω—Ç–∞–∫–ª–µ–π", 
                meaning: "–ë–∞–ª–∞–Ω—Å, –∞–¥–∞–ø—Ç–∞—Ü–∏—è, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã", 
                image: "images/pents02.jpg",
                type: "pentacles"
            },
            { 
                name: "3 –ü–µ–Ω—Ç–∞–∫–ª–µ–π", 
                meaning: "–ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ, —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ, —Ä–µ–º–µ—Å–ª–æ", 
                image: "images/pents03.jpg",
                type: "pentacles"
            },
            { 
                name: "4 –ü–µ–Ω—Ç–∞–∫–ª–µ–π", 
                meaning: "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ, –∫–æ–Ω—Ç—Ä–æ–ª—å, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", 
                image: "images/pents04.jpg",
                type: "pentacles"
            },
            { 
                name: "5 –ü–µ–Ω—Ç–∞–∫–ª–µ–π", 
                meaning: "–ù—É–∂–¥–∞, –±–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–æ, –∏–∑–æ–ª—è—Ü–∏—è", 
                image: "images/pents05.jpg",
                type: "pentacles"
            },
            { 
                name: "6 –ü–µ–Ω—Ç–∞–∫–ª–µ–π", 
                meaning: "–©–µ–¥—Ä–æ—Å—Ç—å, –±–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –æ–±–º–µ–Ω", 
                image: "images/pents06.jpg",
                type: "pentacles"
            },
            { 
                name: "7 –ü–µ–Ω—Ç–∞–∫–ª–µ–π", 
                meaning: "–¢–µ—Ä–ø–µ–Ω–∏–µ, –æ—Ü–µ–Ω–∫–∞, –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã", 
                image: "images/pents07.jpg",
                type: "pentacles"
            },
            { 
                name: "8 –ü–µ–Ω—Ç–∞–∫–ª–µ–π", 
                meaning: "–ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ, –∫–∞—á–µ—Å—Ç–≤–æ, —Ä–µ–º–µ—Å–ª–æ", 
                image: "images/pents08.jpg",
                type: "pentacles"
            },
            { 
                name: "9 –ü–µ–Ω—Ç–∞–∫–ª–µ–π", 
                meaning: "–ò–∑–æ–±–∏–ª–∏–µ, —Ä–æ—Å–∫–æ—à—å, —Å–∞–º–æ–æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ", 
                image: "images/pents09.jpg",
                type: "pentacles"
            },
            { 
                name: "10 –ü–µ–Ω—Ç–∞–∫–ª–µ–π", 
                meaning: "–ë–æ–≥–∞—Ç—Å—Ç–≤–æ, –Ω–∞—Å–ª–µ–¥–∏–µ, —Å–µ–º—å—è", 
                image: "images/pents10.jpg",
                type: "pentacles"
            },
            { 
                name: "–ü–∞–∂ –ü–µ–Ω—Ç–∞–∫–ª–µ–π", 
                meaning: "–ò–∑—É—á–µ–Ω–∏–µ, —É—Å–µ—Ä–¥–∏–µ, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª", 
                image: "images/pents11.jpg",
                type: "pentacles"
            },
            { 
                name: "–†—ã—Ü–∞—Ä—å –ü–µ–Ω—Ç–∞–∫–ª–µ–π", 
                meaning: "–¢—Ä—É–¥–æ–ª—é–±–∏–µ, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å", 
                image: "images/pents12.jpg",
                type: "pentacles"
            },
            { 
                name: "–ö–æ—Ä–æ–ª–µ–≤–∞ –ü–µ–Ω—Ç–∞–∫–ª–µ–π", 
                meaning: "–ò–∑–æ–±–∏–ª–∏–µ, –∫–æ–º—Ñ–æ—Ä—Ç, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", 
                image: "images/pents13.jpg",
                type: "pentacles"
            },
            { 
                name: "–ö–æ—Ä–æ–ª—å –ü–µ–Ω—Ç–∞–∫–ª–µ–π", 
                meaning: "–ü—Ä–æ—Ü–≤–µ—Ç–∞–Ω–∏–µ, –±–∏–∑–Ω–µ—Å, –ª–∏–¥–µ—Ä—Å—Ç–≤–æ", 
                image: "images/pents14.jpg",
                type: "pentacles"
            }
        ];

        class TarotApp {
            constructor() {
                this.selectedCards = [];
                this.currentCards = [];
                this.question = this.getQuestionFromUrl();
                this.imageLoadErrors = new Set();
                this.deckType = 'full';
                this.cardBackLoaded = false;
                this.backgroundLoaded = false;
                this.isMobile = this.detectMobile();
                this.screenSize = this.getScreenSize();
                this.init();
            }

            detectMobile() {
                return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                       window.innerWidth <= 768;
            }

            getScreenSize() {
                const width = window.innerWidth;
                if (width <= 320) return 'xs';
                if (width <= 375) return 'sm';
                if (width <= 425) return 'md';
                if (width <= 767) return 'lg';
                return 'xl';
            }

            init() {
                this.renderQuestion();
                this.preloadAssets();
                this.generateCards();
                this.setupEventListeners();
                this.setupViewport();
                this.updateLayout();
                console.log('Tarot App initialized - Mobile:', this.isMobile, 'Screen:', this.screenSize);
            }

            setupViewport() {
                const viewport = document.querySelector('meta[name="viewport"]');
                if (viewport) {
                    viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no');
                }
            }

            updateLayout() {
                document.body.className = '';
                document.body.classList.add(`screen-${this.screenSize}`);
                if (this.isMobile) {
                    document.body.classList.add('mobile');
                }
                
                this.renderCards();
            }

            preloadAssets() {
                this.loadBackground();
                this.loadCardBack();
            }

            loadBackground() {
                const bgImage = new Image();
                bgImage.src = 'images/background.jpg';
                
                bgImage.onload = () => {
                    console.log('‚úÖ –§–æ–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω');
                    this.backgroundLoaded = true;
                    this.applyBackground();
                };
                
                bgImage.onerror = () => {
                    console.warn('‚ùå –§–æ–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç');
                    this.backgroundLoaded = false;
                    this.applyBackground();
                };
            }

            applyBackground() {
                if (this.backgroundLoaded) {
                    document.body.style.backgroundImage = 'url("images/background.jpg")';
                    document.body.style.backgroundSize = 'cover';
                    document.body.style.backgroundPosition = 'center';
                    document.body.style.backgroundRepeat = 'no-repeat';
                    document.body.style.backgroundAttachment = 'fixed';
                } else {
                    document.body.style.backgroundImage = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                    document.body.style.backgroundSize = 'auto';
                    document.body.style.backgroundAttachment = 'fixed';
                }
            }

            loadCardBack() {
                const cardBackImage = new Image();
                cardBackImage.src = 'images/card_back.jpg';
                
                cardBackImage.onload = () => {
                    console.log('‚úÖ –†—É–±–∞—à–∫–∞ –∫–∞—Ä—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
                    this.cardBackLoaded = true;
                    this.updateCardBacks();
                };
                
                cardBackImage.onerror = () => {
                    console.warn('‚ùå –†—É–±–∞—à–∫–∞ –∫–∞—Ä—Ç –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback');
                    this.cardBackLoaded = false;
                    this.updateCardBacks();
                };
            }

            updateCardBacks() {
                const cardBacks = document.querySelectorAll('.card-back');
                cardBacks.forEach(back => {
                    if (this.cardBackLoaded) {
                        back.classList.remove('fallback');
                        back.style.backgroundImage = 'url("images/card_back.jpg")';
                        back.style.backgroundSize = 'cover';
                        back.style.backgroundPosition = 'center';
                        back.style.backgroundRepeat = 'no-repeat';
                    } else {
                        back.classList.add('fallback');
                        back.style.backgroundImage = 'linear-gradient(45deg, #8B4513, #A0522D)';
                    }
                });
            }

            getQuestionFromUrl() {
                const urlParams = new URLSearchParams(window.location.search);
                const question = urlParams.get('question');
                return question ? decodeURIComponent(question) : '–í–æ–ø—Ä–æ—Å –Ω–µ —É–∫–∞–∑–∞–Ω';
            }

            renderQuestion() {
                const questionElement = document.getElementById('questionText');
                if (questionElement) {
                    questionElement.textContent = this.question;
                }
            }

            generateCards() {
                let availableCards = [];
                
                if (this.deckType === 'major') {
                    availableCards = TAROT_DECK.filter(card => card.type === 'major');
                } else {
                    availableCards = [...TAROT_DECK];
                }
                
                const shuffled = availableCards.sort(() => Math.random() - 0.5);
                this.currentCards = shuffled.slice(0, 7);
                this.renderCards();
            }

            renderCards() {
                const container = document.getElementById('cardsContainer');
                if (!container) return;
                
                container.innerHTML = '';

                this.currentCards.forEach((card, index) => {
                    const cardElement = this.createCardElement(card, index);
                    container.appendChild(cardElement);
                });
                
                setTimeout(() => {
                    this.updateCardBacks();
                }, 100);
                
                this.updateResults();
            }

            createCardElement(card, index) {
                const cardElement = document.createElement('div');
                cardElement.className = 'card';
                
                const cardBackClass = this.cardBackLoaded ? '' : 'fallback';
                
                cardElement.innerHTML = `
                    <div class="card-inner">
                        <div class="card-back ${cardBackClass}"></div>
                        <div class="card-front">
                            <img src="${card.image}" alt="${card.name}" class="card-image"
                                 onerror="this.handleImageError(this)">
                            <div class="card-info">
                                <div class="card-name">${this.getShortName(card.name)}</div>
                                <div class="card-meaning">${card.meaning}</div>
                            </div>
                        </div>
                    </div>
                `;

                cardElement.addEventListener('click', () => this.toggleCard(card, index));
                return cardElement;
            }

            handleImageError(imgElement) {
                imgElement.style.display = 'none';
                const cardInfo = imgElement.nextElementSibling;
                if (cardInfo) {
                    cardInfo.style.display = 'flex';
                    cardInfo.style.alignItems = 'center';
                    cardInfo.style.justifyContent = 'center';
                    cardInfo.style.height = '100%';
                    cardInfo.style.flexDirection = 'column';
                    cardInfo.style.padding = '10px';
                    cardInfo.style.textAlign = 'center';
                    cardInfo.style.background = 'linear-gradient(135deg, #8B4513, #A0522D)';
                    cardInfo.style.color = 'white';
                }
            }

            getShortName(fullName) {
                return fullName.replace(/^[IVXLCDM]+\.\s*/, '').replace(/^0\.\s*/, '');
            }

            toggleCard(card, index) {
                const cardElement = document.querySelectorAll('.card')[index];
                if (!cardElement) return;
                
                const isSelected = this.selectedCards.some(c => c.name === card.name);

                if (isSelected) {
                    this.selectedCards = this.selectedCards.filter(c => c.name !== card.name);
                    cardElement.classList.remove('selected', 'flipped');
                } else {
                    if (this.selectedCards.length < 3) {
                        this.selectedCards.push(card);
                        cardElement.classList.add('selected', 'flipped');
                    } else {
                        this.showError('–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ 3 –∫–∞—Ä—Ç—ã!');
                        return;
                    }
                }

                this.updateCounter();
                this.updateSubmitButton();
                this.updateResults();
            }

            updateCounter() {
                const counter = document.getElementById('selectedCount');
                if (counter) {
                    counter.textContent = this.selectedCards.length;
                }
            }

            updateSubmitButton() {
                const submitBtn = document.getElementById('submitBtn');
                if (submitBtn) {
                    submitBtn.disabled = this.selectedCards.length !== 3;
                }
            }

            updateResults() {
                const resultsContainer = document.getElementById('resultsContainer');
                const list = document.getElementById('selectedCardsList');
                
                if (this.selectedCards.length > 0) {
                    resultsContainer.style.display = 'block';
                    list.innerHTML = this.selectedCards.map(card => 
                        `<div class="selected-card-item">${this.getShortName(card.name)}</div>`
                    ).join('');
                } else {
                    resultsContainer.style.display = 'none';
                }
            }

            showError(message) {
                if (window.Telegram && window.Telegram.WebApp) {
                    window.Telegram.WebApp.showPopup({
                        title: '–í–Ω–∏–º–∞–Ω–∏–µ',
                        message: message,
                        buttons: [{ type: 'ok' }]
                    });
                } else {
                    alert(message);
                }
            }

            setupEventListeners() {
                const submitBtn = document.getElementById('submitBtn');
                const shuffleBtn = document.getElementById('shuffleBtn');
                
                if (submitBtn) {
                    submitBtn.addEventListener('click', () => this.submitCards());
                }
                if (shuffleBtn) {
                    shuffleBtn.addEventListener('click', () => this.shuffleCards());
                }

                window.addEventListener('resize', () => {
                    this.handleResize();
                });

                document.addEventListener('touchstart', (e) => {
                    if (e.touches.length > 1) {
                        e.preventDefault();
                    }
                }, { passive: false });

                let lastTouchEnd = 0;
                document.addEventListener('touchend', (e) => {
                    const now = Date.now();
                    if (now - lastTouchEnd <= 300) {
                        e.preventDefault();
                    }
                    lastTouchEnd = now;
                }, false);
            }

            handleResize() {
                const oldScreenSize = this.screenSize;
                this.screenSize = this.getScreenSize();
                this.isMobile = this.detectMobile();
                
                if (oldScreenSize !== this.screenSize) {
                    this.updateLayout();
                }
                
                if (window.innerHeight < 500) {
                    document.body.classList.add('landscape');
                } else {
                    document.body.classList.remove('landscape');
                }
            }

            submitCards() {
                if (this.selectedCards.length !== 3) {
                    this.showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ 3 –∫–∞—Ä—Ç—ã');
                    return;
                }

                const result = {
                    question: this.question,
                    cards: this.selectedCards.map(card => card.name),
                    meanings: this.selectedCards.map(card => card.meaning),
                    deck_type: this.deckType,
                    timestamp: new Date().toISOString()
                };

                console.log('–û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö:', result);

                if (window.Telegram && window.Telegram.WebApp) {
                    window.Telegram.WebApp.sendData(JSON.stringify(result));
                    window.Telegram.WebApp.showPopup({
                        title: '–£—Å–ø–µ—à–Ω–æ',
                        message: '–†–∞—Å–∫–ª–∞–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!',
                        buttons: [{ type: 'ok' }]
                    });
                    setTimeout(() => {
                        window.Telegram.WebApp.close();
                    }, 1000);
                } else {
                    const resultText = `–†–∞—Å–∫–ª–∞–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!\n\n–í–æ–ø—Ä–æ—Å: ${result.question}\n–ö–∞—Ä—Ç—ã:\n${this.selectedCards.map((card, index) => `${index + 1}. ${card.name} - ${card.meaning}`).join('\n')}`;
                    
                    if (window.confirm(resultText + '\n\n–ù–∞–∂–º–∏—Ç–µ OK –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è')) {
                        console.log('–†–∞—Å–∫–ª–∞–¥ –∑–∞–≤–µ—Ä—à–µ–Ω');
                    }
                }
            }

            shuffleCards() {
                const cards = document.querySelectorAll('.card');
                
                cards.forEach((card, index) => {
                    setTimeout(() => {
                        card.style.transform = 'rotate(3deg)';
                        setTimeout(() => {
                            card.style.transform = 'rotate(-3deg)';
                            setTimeout(() => {
                                card.style.transform = 'rotate(0deg)';
                            }, 100);
                        }, 100);
                    }, index * 50);
                });

                setTimeout(() => {
                    this.selectedCards = [];
                    this.generateCards();
                    this.updateCounter();
                    this.updateSubmitButton();
                    this.updateResults();
                    
                    const newCards = document.querySelectorAll('.card');
                    newCards.forEach(card => {
                        card.style.animation = 'none';
                        setTimeout(() => {
                            card.style.animation = 'selectCard 0.5s ease';
                        }, 10);
                    });
                }, 400);
            }

            debugInfo() {
                console.log('=== Tarot App Debug Info ===');
                console.log('Selected cards:', this.selectedCards.length);
                console.log('Current cards:', this.currentCards.length);
                console.log('Question:', this.question);
                console.log('Mobile:', this.isMobile);
                console.log('Screen size:', this.screenSize);
                console.log('Background loaded:', this.backgroundLoaded);
                console.log('Card back loaded:', this.cardBackLoaded);
                console.log('============================');
            }

            reloadBackground() {
                this.loadBackground();
            }

            reloadCardBack() {
                this.loadCardBack();
            }
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            window.tarotApp = new TarotApp();
            
            // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
            window.reloadBackground = function() {
                if (window.tarotApp) {
                    window.tarotApp.reloadBackground();
                }
            };
            
            window.reloadCardBack = function() {
                if (window.tarotApp) {
                    window.tarotApp.reloadCardBack();
                }
            };
            
            window.debugTarot = function() {
                if (window.tarotApp) {
                    window.tarotApp.debugInfo();
                }
            };
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            window.addEventListener('error', (e) => {
                if (e.target.tagName === 'IMG') {
                    console.warn('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:', e.target.src);
                    if (window.tarotApp && window.tarotApp.handleImageError) {
                        window.tarotApp.handleImageError(e.target);
                    }
                }
            }, true);
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('visibilitychange', () => {
            if (!document.hidden && window.tarotApp) {
                console.log('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤');
                window.tarotApp.updateCardBacks();
            }
        });
    </script>
</body>
</html>
